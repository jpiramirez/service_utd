<?xml version="1.0"?>

<launch>
  <!--include file="$(find gazebo_ros)/launch/empty_world.launch"/-->

  <!--include file="$(find gazebo_ros)/launch/empty_world.launch">
    <arg name="world_name" default="$(find service_utd)/worlds/servicebatch.world"/>
    <arg name="headless" value="true" />
    <arg name="gui" value="false" />
  </include-->
  <param name="/use_sim_time" value="true" />

  <group ns="target">


        <!--rosparam param="ugs/x">[26.8,27.96,34.04,20.24,25.71,11.29]</rosparam>
				<rosparam param="ugs/y">[24,20.08,26.11,22.30,28.31,7.51]</rosparam-->
        <rosparam param="ugs/x">[-100]</rosparam>
				<rosparam param="ugs/y">[-100]</rosparam>
				<param name="detection_radius" value="1" />
				<param name="comm_radius" value="2" />
				<param name="alpha" value="0.95" />
				<param name="beta" value="0.01" />
				<rosparam param="UAVconnectivity">[1,2,3,4]</rosparam>
				<node name="groundsensors" pkg="service_utd" type="groundsensors" output="screen" />


      </group>

      <group ns="uav1">
        <param name="worldframe" value="/world" />
        <param name="baselink" value="/uav1/base_link" />
        <param name="targetdetect/camera_info_url" value="$(find service_utd)/calibration.yml" />
        <param name="tf_prefix" value="uav1" />

        <!--node name="tf2posestamped" pkg="service_utd" type="tf2posestamped" respawn="true" /-->
        <rosparam param="droneinit">[-1.0,24.362551,0,0]</rosparam>
        <node name="fakedrone" pkg="service_utd" type="fakedrone" output="screen" />
        <node name="joy_node" pkg="joy" type="joy_node" respawn="true"/>
        <node name="drone_joystick" pkg="service_utd" type="joy2drone.py" respawn="true" />
        <rosparam param="drone_setpoint/gains">[0.4,0.4,0.8,0.8,0.8,1.2,0.8]</rosparam>
        <node name="drone_setpoint" pkg="service_utd" type="drone_setpoint" respawn="true" />

        <!--param name="targetdetect/color" value="0 0 255" type="str" />
        <node name="targetdetector" pkg="service_utd" type="targetdetector" respawn="true" >
          <remap from="image" to="downward_cam/camera/image" />
        </node-->
        <param name="target_topic" value="/target/p3dx/base_pose_ground_truth" />
        <param name="targetdetect/targetsize" value="3.0" />
        <node name="fakedetector" pkg="service_utd" type="fakedetector" respawn="true" />


        <param name="waypoints/x" value="-2 2 2 -2 -2 2" />
        <param name="waypoints/y" value="1.5 1.5 0 0 -1.5 -1.5" />
        <param name="waypoints/z" value="2 2 2 2 2 2" />
        <param name="waypointNav" value="false" type="bool" />
        <param name="alpha" value="0.95" />
        <param name="beta" value="0.01" />
        <param name="detection_radius" value="10" />
        <param name="collision_radius" value="10.0" />
        <param name="num_particles" value="4000" />
        <param name="mapname" value="$(find service_utd)/matlabmap.yml" />
        <rosparam param="UAVdetectability">[2,3,4]</rosparam>
        <rosparam param="UAVconnectivity">[2,3,4]</rosparam>
        <param name="base_altitude" value="4" />
        <param name="batchsimulation" value="true" />
        <param name="memsize" value="1" />
        <param name="plan_length" value="5" />
        <node name="pathplanner" pkg="service_utd" type="pathplanner" required="true" output="screen"/>

        <param name="controller/twist/linear/xy/k_d" value="0.0" />
        <param name="controller/twist/linear/xy/k_i" value="0.5" />
        <param name="controller/twist/linear/xy/k_p" value="2.0" />

      </group>

      <group ns="uav2">
        <param name="targetdetect/camera_info_url" value="$(find service_utd)/calibration.yml" />
        <param name="tf_prefix" value="uav2" />

        <!--node name="tf2posestamped" pkg="service_utd" type="tf2posestamped" respawn="true" /-->
        <rosparam param="droneinit">[42.280787,38.019486,0,0]</rosparam>
        <node name="fakedrone" pkg="service_utd" type="fakedrone" output="screen" />
        <node name="joy_node" pkg="joy" type="joy_node" respawn="true"/>
        <node name="drone_joystick" pkg="service_utd" type="joy2drone.py" respawn="true" />
        <rosparam param="drone_setpoint/gains">[0.4,0.4,0.8,0.8,0.8,1.2,0.8]</rosparam>
        <node name="drone_setpoint" pkg="service_utd" type="drone_setpoint" respawn="true" />

        <param name="worldframe" value="/world" />
        <param name="baselink" value="/uav2/base_link" />

        <!--param name="targetdetect/color" value="0 0 255" type="str" />
        <node name="targetdetector" pkg="service_utd" type="targetdetector" respawn="true" >
          <remap from="image" to="downward_cam/camera/image" />
        </node-->
        <param name="target_topic" value="/target/p3dx/base_pose_ground_truth" />
        <param name="targetdetect/targetsize" value="3.0" />
        <node name="fakedetector" pkg="service_utd" type="fakedetector" respawn="true" />

        <param name="waypoints/x" value="-2 2 2 -2 -2 2" />
        <param name="waypoints/y" value="1.5 1.5 0 0 -1.5 -1.5" />
        <param name="waypoints/z" value="2 2 2 2 2 2" />
        <param name="waypointNav" value="false" type="bool" />
        <param name="alpha" value="0.95" />
        <param name="beta" value="0.01" />
        <param name="detection_radius" value="10" />
        <param name="collision_radius" value="10.0" />
        <param name="num_particles" value="4000" />
        <param name="mapname" value="$(find service_utd)/matlabmap.yml" />
        <rosparam param="UAVdetectability">[1,3,4]</rosparam>
        <rosparam param="UAVconnectivity">[1,3,4]</rosparam>
        <param name="base_altitude" value="4" />
        <param name="batchsimulation" value="true" />
        <param name="memsize" value="1" />
        <param name="plan_length" value="5" />
        <node name="pathplanner" pkg="service_utd" type="pathplanner" required="true" output="screen"/>

        <param name="controller/twist/linear/xy/k_d" value="0.0" />
        <param name="controller/twist/linear/xy/k_i" value="0.5" />
        <param name="controller/twist/linear/xy/k_p" value="2.0" />


      </group>

      <group ns="uav3">
        <param name="targetdetect/camera_info_url" value="$(find service_utd)/calibration.yml" />
        <param name="tf_prefix" value="uav3" />

        <!--node name="tf2posestamped" pkg="service_utd" type="tf2posestamped" respawn="true" /-->
        <rosparam param="droneinit">[41.764476,12.914353,0,0]</rosparam>
        <node name="fakedrone" pkg="service_utd" type="fakedrone" output="screen" />
        <node name="joy_node" pkg="joy" type="joy_node" respawn="true"/>
        <node name="drone_joystick" pkg="service_utd" type="joy2drone.py" respawn="true" />
        <rosparam param="drone_setpoint/gains">[0.4,0.4,0.8,0.8,0.8,1.2,0.8]</rosparam>
        <node name="drone_setpoint" pkg="service_utd" type="drone_setpoint" respawn="true" />

        <param name="worldframe" value="/world" />
        <param name="baselink" value="/uav3/base_link" />

        <!--param name="targetdetect/color" value="0 0 255" type="str" />
        <node name="targetdetector" pkg="service_utd" type="targetdetector" respawn="true" >
          <remap from="image" to="downward_cam/camera/image" />
        </node-->
        <param name="target_topic" value="/target/p3dx/base_pose_ground_truth" />
        <param name="targetdetect/targetsize" value="3.0" />
        <node name="fakedetector" pkg="service_utd" type="fakedetector" respawn="true" />

        <param name="waypoints/x" value="-2 2 2 -2 -2 2" />
        <param name="waypoints/y" value="1.5 1.5 0 0 -1.5 -1.5" />
        <param name="waypoints/z" value="2 2 2 2 2 2" />
        <param name="waypointNav" value="false" type="bool" />
        <param name="alpha" value="0.95" />
        <param name="beta" value="0.01" />
        <param name="detection_radius" value="10" />
        <param name="collision_radius" value="10.0" />
        <param name="num_particles" value="4000" />
        <param name="mapname" value="$(find service_utd)/matlabmap.yml" />
        <rosparam param="UAVdetectability">[1,2,4]</rosparam>
        <rosparam param="UAVconnectivity">[1,2,4]</rosparam>
        <param name="base_altitude" value="4" />
        <param name="batchsimulation" value="true" />
        <param name="memsize" value="1" />
        <param name="plan_length" value="5" />
        <node name="pathplanner" pkg="service_utd" type="pathplanner" required="true" output="screen"/>

        <param name="controller/twist/linear/xy/k_d" value="0.0" />
        <param name="controller/twist/linear/xy/k_i" value="0.5" />
        <param name="controller/twist/linear/xy/k_p" value="2.0" />

      </group>

      <group ns="uav4">
        <param name="targetdetect/camera_info_url" value="$(find service_utd)/calibration.yml" />
        <param name="tf_prefix" value="uav4" />

        <!--node name="tf2posestamped" pkg="service_utd" type="tf2posestamped" respawn="true" /-->
        <rosparam param="droneinit">[5.969434,-1.0,0,0]</rosparam>
        <node name="fakedrone" pkg="service_utd" type="fakedrone" output="screen" />
        <node name="joy_node" pkg="joy" type="joy_node" respawn="true"/>
        <node name="drone_joystick" pkg="service_utd" type="joy2drone.py" respawn="true" />
        <rosparam param="drone_setpoint/gains">[0.4,0.4,0.8,0.8,0.8,1.2,0.8]</rosparam>
        <node name="drone_setpoint" pkg="service_utd" type="drone_setpoint" respawn="true" />

        <param name="worldframe" value="/world" />
        <param name="baselink" value="/uav4/base_link" />

        <!--param name="targetdetect/color" value="0 0 255" type="str" />
        <node name="targetdetector" pkg="service_utd" type="targetdetector" respawn="true" >
          <remap from="image" to="downward_cam/camera/image" />
        </node-->
        <param name="target_topic" value="/target/p3dx/base_pose_ground_truth" />
        <param name="targetdetect/targetsize" value="3.0" />
        <node name="fakedetector" pkg="service_utd" type="fakedetector" respawn="true" />

        <param name="waypoints/x" value="-2 2 2 -2 -2 2" />
        <param name="waypoints/y" value="1.5 1.5 0 0 -1.5 -1.5" />
        <param name="waypoints/z" value="2 2 2 2 2 2" />
        <param name="waypointNav" value="false" type="bool" />
        <param name="alpha" value="0.95" />
        <param name="beta" value="0.01" />
        <param name="detection_radius" value="10" />
        <param name="collision_radius" value="10.0" />
        <param name="num_particles" value="4000" />
        <param name="mapname" value="$(find service_utd)/matlabmap.yml" />
        <rosparam param="UAVdetectability">[1,2,3]</rosparam>
        <rosparam param="UAVconnectivity">[1,2,3]</rosparam>
        <param name="base_altitude" value="4" />
        <param name="batchsimulation" value="true" />
        <param name="memsize" value="1" />
        <param name="plan_length" value="5" />
        <node name="pathplanner" pkg="service_utd" type="pathplanner" required="true" output="screen"/>

        <param name="controller/twist/linear/xy/k_d" value="0.0" />
        <param name="controller/twist/linear/xy/k_i" value="0.5" />
        <param name="controller/twist/linear/xy/k_p" value="2.0" />

      </group>

    </launch>
